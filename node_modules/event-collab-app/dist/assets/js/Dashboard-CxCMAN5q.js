import{j as e,u as a,c as t,b as r}from"./query-CYHn1j2-.js";import{r as s}from"./react-vendor-BU4UtguS.js";import{c as i,a as l}from"./eventService-B4wxl7w5.js";import{E as d}from"./EventCard-hwEpKrJV.js";import{z as o,b as n,D as c,B as m,n as x}from"./index-DT-T-1C3.js";import{A as g,m as h,e as y,P as u,f as p,F as b}from"./ui-C2-6eSzT.js";import"./router-BmPrQWNH.js";import"./utils-ki6RHjvQ.js";const j=({isOpen:a,onClose:t,title:r,children:s})=>e.jsx(g,{children:a&&e.jsx(h.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",onClick:t,children:e.jsxs(h.div,{initial:{y:-30,opacity:0},animate:{y:0,opacity:1},exit:{y:30,opacity:0},className:"relative w-full max-w-lg bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:r}),e.jsx("button",{onClick:t,className:"p-1 rounded-full text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700",children:e.jsx(y,{size:20})})]}),s]})})}),v=({onClose:r})=>{const[l,d]=s.useState(""),[n,c]=s.useState(""),m=(new Date).toISOString().split("T")[0],[x,g]=s.useState(m),[h,y]=s.useState(""),u=a(),p=t({mutationFn:i,onSuccess:()=>{o.success("Event created successfully!"),u.invalidateQueries({queryKey:["events"]}),r()},onError:e=>{if(400===e.response?.status&&e.response?.data?.errors){const a=e.response.data.errors.find(e=>"date"===e.field);if(a)return void o.error(a.defaultMessage)}o.error(e.response?.data?.message||"Failed to create event.")}});return e.jsxs("form",{onSubmit:e=>{e.preventDefault(),p.mutate({name:l,description:n,date:x,location:h})},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Event Name"}),e.jsx("input",{type:"text",id:"name",value:l,onChange:e=>d(e.target.value),required:!0,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Description"}),e.jsx("textarea",{id:"description",value:n,onChange:e=>c(e.target.value),required:!0,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 shadow-sm"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Date"}),e.jsx("input",{type:"date",id:"date",value:x,min:m,onChange:e=>g(e.target.value),required:!0,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Location"}),e.jsx("input",{type:"text",id:"location",value:h,onChange:e=>y(e.target.value),className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 shadow-sm"})]})]}),e.jsx("div",{className:"flex justify-end pt-2",children:e.jsx("button",{type:"submit",disabled:p.isPending,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50",children:p.isPending?"Creating...":"Create Event"})})]})},f=()=>{const[a,t]=s.useState(!1),[i,o]=s.useState(""),[f,N]=s.useState(""),[w,k]=s.useState(!1),{searchQuery:C,filters:S,setSearchQuery:F,setFilters:E,clearFilters:L}=n(),{data:q,isLoading:D,error:P,refetch:z}=r({queryKey:["events"],queryFn:l,onError:e=>{x.error("Failed to load events")}}),M=s.useMemo(()=>q?q.filter(e=>{const a=!i||e.name.toLowerCase().includes(i.toLowerCase())||e.description.toLowerCase().includes(i.toLowerCase())||e.location?.toLowerCase().includes(i.toLowerCase()),t=!f||e.category===f;return a&&t}):[],[q,i,f]),O=s.useMemo(()=>{if(!q)return[];return[...new Set(q.map(e=>e.category).filter(Boolean))]},[q]);return D?e.jsx(c,{}):e.jsxs(e.Fragment,{children:[" ",e.jsxs(h.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"container mx-auto p-4 sm:p-6",children:[e.jsxs("header",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Dashboard"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Welcome! Here are your upcoming events."})]}),e.jsxs(m,{onClick:()=>t(!0),children:[e.jsx(u,{className:"w-4 h-4 mr-2"}),"Create Event"]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-4",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx(p,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search events...",value:i,onChange:e=>{o(e.target.value)},className:"w-full pl-10 pr-4 py-2 rounded-md bg-white dark:bg-white/10 border border-gray-300 dark:border-white/20 text-gray-900 dark:text-white placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(m,{variant:"outline",onClick:()=>k(!w),className:"flex items-center gap-2",children:[e.jsx(b,{className:"w-4 h-4"}),"Filters"]}),(i||f)&&e.jsxs(m,{variant:"outline",onClick:()=>{o(""),N(""),k(!1)},className:"flex items-center gap-2 text-red-600 hover:text-red-700",children:[e.jsx(y,{className:"w-4 h-4"}),"Clear"]})]})]}),e.jsx(g,{children:w&&e.jsx(h.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700 mb-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category"}),e.jsxs("select",{value:f,onChange:e=>N(e.target.value),className:"w-full px-3 py-2 rounded-md bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"All Categories"}),O.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Date"}),e.jsx("input",{type:"date",className:"w-full px-3 py-2 rounded-md bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(m,{onClick:()=>z(),variant:"outline",className:"w-full",children:"Refresh"})})]})})})]}),P&&e.jsxs(h.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200 px-4 py-3 rounded-md mb-6",children:[e.jsx("p",{children:"Failed to load events. Please try again."}),e.jsx(m,{onClick:()=>z(),className:"mt-2",size:"sm",children:"Retry"})]}),M&&e.jsxs("div",{className:"mb-4 text-sm text-gray-600 dark:text-gray-400",children:["Showing ",M.length," of ",q?.length||0," events",(i||f)&&e.jsxs("span",{className:"ml-2",children:[i&&`• Search: "${i}"`,f&&`• Category: ${f}`]})]}),e.jsx(g,{mode:"wait",children:0!==M.length||D?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:M.map((a,t)=>e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.9},transition:{delay:.05*t},layout:!0,children:e.jsx(d,{event:a})},a.id))}):e.jsxs(h.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-center py-12",children:[e.jsxs("div",{className:"text-gray-400 dark:text-gray-600 mb-4",children:[e.jsx(u,{className:"w-16 h-16 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:i||f?"No events found":"No events yet"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:i||f?"Try adjusting your search or filters":"Create your first event to get started"})]}),!i&&!f&&e.jsxs(m,{onClick:()=>t(!0),children:[e.jsx(u,{className:"w-4 h-4 mr-2"}),"Create Event"]})]})})]}),e.jsx(j,{isOpen:a,onClose:()=>t(!1),title:"Create a New Event",children:e.jsx(v,{onClose:()=>t(!1)})})]})};export{f as default};
