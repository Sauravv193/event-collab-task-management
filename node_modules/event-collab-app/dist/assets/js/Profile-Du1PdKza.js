import{b as e,c as s,j as a}from"./query-CYHn1j2-.js";import{r}from"./react-vendor-BU4UtguS.js";import{a as t,u as d,L as n,B as i,z as l}from"./index-DT-T-1C3.js";import{g as o,a as c}from"./eventService-B4wxl7w5.js";import{m,h as x,n as u,o as g,p}from"./ui-C2-6eSzT.js";import"./router-BmPrQWNH.js";import"./utils-ki6RHjvQ.js";const h=async e=>{const{data:s}=await t.put("/users/change-password",e);return s},y=()=>{const{user:t}=d(),[y,j]=r.useState(""),[b,f]=r.useState(""),{data:w,isLoading:N}=e({queryKey:["my-events"],queryFn:o}),{data:v,isLoading:k}=e({queryKey:["events"],queryFn:c}),P=s({mutationFn:h,onSuccess:()=>{l.success("Password updated successfully!"),j(""),f("")},onError:e=>{l.error(e.response?.data?.message||"Failed to update password.")}});if(N||k)return a.jsx(n,{});const q=v?.filter(e=>e.createdBy.username===t.username).length;return a.jsxs(m.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"container mx-auto p-4 sm:p-6",children:[a.jsxs("header",{className:"mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Profile & Settings"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Manage your account settings and preferences."})]}),a.jsxs("div",{className:"max-w-2xl mx-auto space-y-8",children:[a.jsxs("div",{className:"p-6 bg-white dark:bg-white/10 backdrop-blur-xl border border-gray-200 dark:border-white/20 shadow-lg rounded-2xl",children:[a.jsxs("h2",{className:"text-2xl font-bold mb-4 flex items-center gap-3",children:[a.jsx(x,{})," Profile"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("p",{className:"text-gray-700 dark:text-gray-300 flex items-center gap-2",children:[a.jsx(x,{size:16})," Username"]}),a.jsx("p",{className:"font-semibold",children:t?.username})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("p",{className:"text-gray-700 dark:text-gray-300 flex items-center gap-2",children:[a.jsx(u,{size:16})," Events Joined"]}),a.jsx("p",{className:"font-semibold",children:w?.length||0})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("p",{className:"text-gray-700 dark:text-gray-300 flex items-center gap-2",children:[a.jsx(g,{size:16})," Events Created"]}),a.jsx("p",{className:"font-semibold",children:q||0})]})]})]}),a.jsxs("div",{className:"p-6 bg-white dark:bg-white/10 backdrop-blur-xl border border-gray-200 dark:border-white/20 shadow-lg rounded-2xl",children:[a.jsxs("h2",{className:"text-2xl font-bold mb-4 flex items-center gap-3",children:[a.jsx(p,{})," Security"]}),a.jsxs("form",{onSubmit:e=>{e.preventDefault(),b.length<6?l.error("New password must be at least 6 characters long."):P.mutate({currentPassword:y,newPassword:b})},className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"current-password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Current Password"}),a.jsx("input",{id:"current-password",type:"password",value:y,onChange:e=>j(e.target.value),required:!0,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 shadow-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"new-password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"New Password"}),a.jsx("input",{id:"new-password",type:"password",value:b,onChange:e=>f(e.target.value),required:!0,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 shadow-sm"})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(i,{type:"submit",disabled:P.isPending,children:P.isPending?"Updating...":"Change Password"})})]})]})]})]})};export{y as default};
