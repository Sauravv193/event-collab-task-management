var y=(t,o,r)=>new Promise((i,l)=>{var c=s=>{try{d(r.next(s))}catch(n){l(n)}},m=s=>{try{d(r.throw(s))}catch(n){l(n)}},d=s=>s.done?i(s.value):Promise.resolve(s.value).then(c,m);d((r=r.apply(t,o)).next())});import{c as h,a as k,u as v,j as e,L as N,m as P,B as C,z as x}from"./index-C9p9T0xJ.js";import{r as g}from"./vendor-CGzxjxki.js";import{u as w,g as M,a as S}from"./eventService-B6VAk_os.js";import{u as E}from"./useMutation-DxIInw50.js";import{U as b}from"./user-DyX5Splb.js";import"./router-BtvKvBzC.js";/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=h("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=h("CalendarPlus",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 13V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"3spt84"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M16 19h6",key:"xwg31i"}],["path",{d:"M19 16v6",key:"tddt3s"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=h("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),z=t=>y(void 0,null,function*(){const{data:o}=yield k.put("/users/change-password",t);return o}),I=()=>{const{user:t}=v(),[o,r]=g.useState(""),[i,l]=g.useState(""),{data:c,isLoading:m}=w({queryKey:["my-events"],queryFn:M}),{data:d,isLoading:s}=w({queryKey:["events"],queryFn:S}),n=E({mutationFn:z,onSuccess:()=>{x.success("Password updated successfully!"),r(""),l("")},onError:a=>{var u,p;x.error(((p=(u=a.response)==null?void 0:u.data)==null?void 0:p.message)||"Failed to update password.")}}),j=a=>{if(a.preventDefault(),i.length<6){x.error("New password must be at least 6 characters long.");return}n.mutate({currentPassword:o,newPassword:i})};if(m||s)return e.jsx(N,{});const f=d==null?void 0:d.filter(a=>a.createdBy.username===t.username).length;return e.jsxs(P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"container mx-auto p-4 sm:p-6",children:[e.jsxs("header",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Profile & Settings"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Manage your account settings and preferences."})]}),e.jsxs("div",{className:"max-w-2xl mx-auto space-y-8",children:[e.jsxs("div",{className:"p-6 bg-white dark:bg-white/10 backdrop-blur-xl border border-gray-200 dark:border-white/20 shadow-lg rounded-2xl",children:[e.jsxs("h2",{className:"text-2xl font-bold mb-4 flex items-center gap-3",children:[e.jsx(b,{})," Profile"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-gray-700 dark:text-gray-300 flex items-center gap-2",children:[e.jsx(b,{size:16})," Username"]}),e.jsx("p",{className:"font-semibold",children:t==null?void 0:t.username})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-gray-700 dark:text-gray-300 flex items-center gap-2",children:[e.jsx(L,{size:16})," Events Joined"]}),e.jsx("p",{className:"font-semibold",children:(c==null?void 0:c.length)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-gray-700 dark:text-gray-300 flex items-center gap-2",children:[e.jsx(q,{size:16})," Events Created"]}),e.jsx("p",{className:"font-semibold",children:f||0})]})]})]}),e.jsxs("div",{className:"p-6 bg-white dark:bg-white/10 backdrop-blur-xl border border-gray-200 dark:border-white/20 shadow-lg rounded-2xl",children:[e.jsxs("h2",{className:"text-2xl font-bold mb-4 flex items-center gap-3",children:[e.jsx(F,{})," Security"]}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"current-password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Current Password"}),e.jsx("input",{id:"current-password",type:"password",value:o,onChange:a=>r(a.target.value),required:!0,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"new-password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"New Password"}),e.jsx("input",{id:"new-password",type:"password",value:i,onChange:a=>l(a.target.value),required:!0,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 shadow-sm"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(C,{type:"submit",disabled:n.isPending,children:n.isPending?"Updating...":"Change Password"})})]})]})]})]})};export{I as default};
